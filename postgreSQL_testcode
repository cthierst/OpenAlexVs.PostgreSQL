\copy (
SELECT DISTINCT ON (publication.id) 
publication.*, source.*, publisher.*, author.*, address.*, openaccess.*, contributor.*, descriptor.*, conference.*, identifier.*, abstract.*, funding.*, grant_data.*, agency.*, reference.*, organization.*  
FROM publication
JOIN source ON source.id = publication.source_id JOIN publisher ON publisher.id = source.publisher_id  
JOIN author ON author.wos_id = publication.id  
LEFT JOIN author_address ON author_address.author_id = author.id  
LEFT JOIN address ON address.id = author_address.address_id  
LEFT JOIN openaccess ON openaccess.wos_id = publication.id  
LEFT JOIN contributor ON contributor.wos_id = publication.id  
LEFT JOIN publication_descriptor ON publication_descriptor.wos_id = publication.id 
LEFT JOIN descriptor ON descriptor.id = publication_descriptor.desc_id  
LEFT JOIN publication_conference ON publication_conference.wos_id = publication.id  
LEFT JOIN conference ON conference.id = publication_conference.conf_id  
LEFT JOIN identifier ON identifier.wos_id = publication.id  
LEFT JOIN abstract ON abstract.wos_id = publication.id  
LEFT JOIN funding ON funding.wos_id = publication.id  
LEFT JOIN publication_grant ON publication_grant.wos_id = publication.id  
LEFT JOIN grant_data ON grant_data.id = publication_grant.grant_id  
LEFT JOIN grant_agency ON grant_agency.grant_id = grant_data.id  
LEFT JOIN agency ON agency.id = grant_agency.agency_id  
LEFT JOIN reference ON reference.citing_id = publication.id  
LEFT JOIN organization_address ON organization_address.address_id = address.id  
LEFT JOIN organization ON organization.id = organization_address.organization_id  
WHERE publisher.unified_name ILIKE '%Springer%'  
AND address.address ILIKE '%Univ Toronto%' )  
TO 'springer-id.csv' CSV HEADER; 
